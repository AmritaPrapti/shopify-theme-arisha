{%- liquid
  assign selected_variant = product_resource.selected_or_first_available_variant
  assign price = selected_variant.price
  assign compare_at_price = selected_variant.compare_at_price

  assign show_sale_badge = false
  assign sale_percentage = 0
  assign discount_amount = 0
  
  # Set default display type if not provided: 'percentage' or 'amount'
  assign display_type = display_type | default: 'percentage'

  if compare_at_price > price and price > 0
    assign discount_amount = compare_at_price | minus: price
    assign sale_percentage = discount_amount | times: 100.0 | divided_by: compare_at_price | round
    if sale_percentage > 0 or discount_amount > 0
      assign show_sale_badge = true
    endif
  endif
-%}

{%- if show_sale_badge -%}
  <div class="sale-amount-badge badge color-{{ settings.sale_amount_badge_color_scheme }}" style="--badge-corner-radius: {{ settings.sale_amount_badge_corner_radius | default: 4 }}px;">
    <span class="sale-amount-text">
      {%- if display_type == 'amount' -%}
        Save {{ discount_amount | money }}
      {%- else -%}
        Save {{ sale_percentage }}%
      {%- endif -%}
    </span>
  </div>
{%- endif -%}

{% # theme-check-disable %}
{% stylesheet %}
  .sale-amount-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

{% endstylesheet %}
{% # theme-check-enable %}